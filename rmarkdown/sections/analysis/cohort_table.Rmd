```{r analysis_cohort_table, echo = FALSE, warning = FALSE, message = FALSE, results = 'hide', cache = FALSE, eval = TRUE}
###################################################################################
## Tabular summaries                                                             ##
###################################################################################
## These are performed for each treatment type, based on the tables in Appendix 4
## of the Statistical Analysis Plan, although in reality these are NOT mutually
## exclusive groups since many people had multiple therapies (the unique profile
## of treatment is defined in the treatment_profile)
##
## Endocrine_Therapy
cohort_table_endocrine_therapy <- list()
cohort_table_endocrine_therapy$eq5d <- ctru::table_summary(df        = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(eq5d_score,
                                                       mobility,
                                                       self_care,
                                                       usual_activity,
                                                       pain_discomfort,
                                                       anxiety_depression),
                                         nomissing = TRUE,
                                         event_name, endocrine_therapy)
cohort_table_endocrine_therapy$eortc_qlq_c30 <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(c30_q1, c30_q2, c30_q3, c30_q4, c30_q5,
                                                       c30_q6, c30_q7, c30_q8, c30_q9, c30_q10,
                                                       c30_q11, c30_q12, c30_q13, c30_q14, c30_q15,
                                                       c30_q16, c30_q17, c30_q18, c30_q19, c30_q20,
                                                       c30_q21, c30_q22, c30_q23, c30_q24, c30_q25,
                                                       c30_q26, c30_q27, c30_q28, ## , c30_q29, c30_q30,
                                                       ql_raw, ql_scale,
                                                       pf_raw, pf_scale,
                                                       rf_raw, rf_scale,
                                                       ef_raw, ef_scale,
                                                       cf_raw, cf_scale,
                                                       sf_raw, sf_scale,
                                                       fa_raw, fa_scale,
                                                       nv_raw, nv_scale,
                                                       pa_raw, pa_scale,
                                                       dy_scale,
                                                       sl_scale,
                                                       ap_scale,
                                                       co_scale,
                                                       di_scale,
                                                       fi_scale),
                                         nomissing = TRUE,
                                         event_name, endocrine_therapy)
cohort_table_endocrine_therapy$eortc_qlq_br23 <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(br23_q31, br23_q32, br23_q33, br23_q34, br23_q35,
                                                       br23_q36, br23_q37, br23_q38, br23_q39, br23_q40,
                                                       br23_q41, br23_q42, br23_q43, br23_q44, br23_q45,
                                                       br23_q46, br23_q47, br23_q48, br23_q49, br23_q50,
                                                       br23_q51, br23_q52, br23_q53,
                                                       brbi_raw, brbi_scale,
                                                       brsef_raw, brsef_scale,
                                                       brsee_scale, brfu_scale,
                                                       brst_raw, brst_scale,
                                                       brbs_raw, brbs_scale,
                                                       bras_raw, bras_scale,
                                                       brhl_scale),
                                         nomissing = TRUE,
                                         event_name, endocrine_therapy)
cohort_table_endocrine_therapy$eortc_qlq_eld15 <- ctru::table_summary(df    = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(eld15_q54, eld15_q55, eld15_q56, eld15_q57, eld15_q58,
                                                       eld15_q59, eld15_q60, eld15_q61, eld15_q62, eld15_q63,
                                                       eld15_q64, eld15_q65, eld15_q66, eld15_q67, eld15_q68,
                                                       mo_raw, mo_scale,
                                                       wao_raw, wao_scale,
                                                       wo_raw, wo_scale,
                                                       mp_raw, mp_scale,
                                                       boi_raw, boi_scale,
                                                       js_scale,
                                                       fs_scale),
                                         nomissing = TRUE,
                                         event_name, endocrine_therapy)
cohort_table_endocrine_therapy$therapy_assessment <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(any_treatment,
                                                       endocrine_therapy,
                                                       radiotherapy,
                                                       endocrine_therapy,
                                                       trastuzumab,
                                                       surgery,
                                                       treatment_profile),
                                         nomissing = TRUE,
                                         event_name)
cohort_table_endocrine_therapy$endocrine_therapy <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(et_hot_flushes,
                                                       et_asthenia,
                                                       et_joint_pain,
                                                       et_vaginal_dryness,
                                                       et_hair_thinning,
                                                       et_rash,
                                                       et_nausea,
                                                       et_diarrhoea,
                                                       et_headache,
                                                       et_vaginal_bleeding,
                                                       et_vomiting,
                                                       et_somnolence),
                                         nomissing = TRUE,
                                         event_name, endocrine_therapy)
cohort_table_endocrine_therapy$radiotherapy <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(## which_breast_right,
                                                       ## which_breast_left,
                                                       r_site_breast,
                                                       r_site_axilla,
                                                       r_site_supraclavicular,
                                                       r_site_chest_wall,
                                                       r_site_other,
                                                       ## r_breast_fractions,
                                                       ## r_axilla_fractions,
                                                       ## r_supra_fractions,
                                                       ## r_chest_fractions,
                                                       ## r_orther_fractions,
                                                       r_radiotherapy_aes,
                                                       l_site_breast,
                                                       l_site_axilla,
                                                       l_site_supraclavicular,
                                                       l_site_chest_wall,
                                                       l_site_other,
                                                       ## l_breast_fractions,
                                                       ## l_axilla_fractions,
                                                       ## l_supra_fractions,
                                                       ## l_chest_fractions,
                                                       ## l_other_fractions,
                                                       l_radiotherapy_aes,
                                                       r_skin_erythema,
                                                       r_pain,
                                                       r_breast_oedema,
                                                       r_breast_shrink,
                                                       r_breast_pain,
                                                       l_skin_erythema,
                                                       l_pain,
                                                       l_breast_oedema,
                                                       l_breast_shrink,
                                                       l_breast_pain),
                                         nomissing = TRUE,
                                         event_name, endocrine_therapy)
cohort_table_endocrine_therapy$endocrine_therapy <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(chemo_received,
                                                       chemo_aes,
                                                       c_fatigue,
                                                       c_anaemia,
                                                       c_low_wc_count,
                                                       c_thrombocytopenia,
                                                       c_allergic,
                                                       c_hair_thinning,
                                                       c_nausea,
                                                       c_infection),
                                         nomissing = TRUE,
                                         event_name, endocrine_therapy)
cohort_table_endocrine_therapy$trastuzumab <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(trast_aes,
                                                       t_cardiac_fail,
                                                       t_flu_like,
                                                       t_nausea,
                                                       t_diarrhoea,
                                                       t_headache,
                                                       t_allergy),
                                         nomissing = TRUE,
                                         event_name, endocrine_therapy)
cohort_table_endocrine_therapy$clinical_assessment_pet <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(## uni_bilateral,
                                                       ## primary_tumour,
                                                       ## r_focal,
                                                       ## r_num_tumours,
                                                       r_cancer_palpable_pet,
                                                       ## r_size_clin_assess_pet,
                                                       r_method_assess_pet,
                                                       ## r_size_ultrasound_pet,
                                                       ## r_size_mammo_pet,
                                                       r_axillary_present_pet,
                                                       ## r_axillary_nodes_pet,
                                                       ## r_axillary_axis_pet,
                                                       ## l_focal,
                                                       ## l_num_tumours_pet,
                                                       l_cancer_palpable_pet,
                                                       ## l_size_clin_assess_pet,
                                                       l_method_assess_pet,
                                                       ## l_size_ultrasound_pet,
                                                       ## l_size_mammo_pet,
                                                       l_axillary_present_pet,
                                                       ## l_axillary_nodes_pet,
                                                       ## l_axillary_axis_pet,
                                                       metastatic,
                                                       metastatic_where_bone,
                                                       metastatic_where_lung,
                                                       metastatic_where_cervical_node,
                                                       metastatic_where_other,
                                                       metastatic_where_liver,
                                                       metastatic_where_brain,
                                                       ## proposed_treat,
                                                       ## clinical_plan2,
                                                       plan_change_surgery,
                                                       plan_change_radio,
                                                       plan_change_antioestrogen,
                                                       plan_change_other), ##,
                                                       ## plan_change_spcfy),
                                         nomissing = TRUE,
                                         event_name, endocrine_therapy)
cohort_table_endocrine_therapy$clinical_assessment_non_pet <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(recurrence_where_breast,
                                                       recurrence_where_chest_wall,
                                                       recurrence_where_axilla,
                                                       recurrence_where_metastatic,
                                                       recurrence_met_bone,
                                                       recurrence_met_liver,
                                                       recurrence_met_lung,
                                                       recurrence_met_superclavicular,
                                                       recurrence_met_brain,
                                                       recurrence_met_other,
                                                       ## recurrence_met_spcfy,
                                                       new_tumour_yn,
                                                       ## new_tumour_dtls,
                                                       ## clinical_plan,
                                                       plan_local_surgery,
                                                       plan_local_radio,
                                                       plan_local_endocrine,
                                                       plan_local_chemo,
                                                       plan_local_trast,
                                                       plan_local_other,
                                                       ## plan_local_spcfy,
                                                       plan_met_radio,
                                                       plan_met_endocrine,
                                                       plan_met_chemo,
                                                       plan_met_trast,
                                                       plan_met_other,
                                                       ## plan_met_spcfy,
                                                       plan_routine_surgery,
                                                       plan_routine_radio,
                                                       plan_routine_endocrine,
                                                       plan_routine_chemo,
                                                       plan_routine_trast,
                                                       plan_routine_other), ## ,
                                                       ## plan_routine_spcfy),
                                         nomissing = TRUE,
                                         event_name, endocrine_therapy)

## Radiotherapy
cohort_table_radiotherapy <- list()
cohort_table_radiotherapy$eq5d <- ctru::table_summary(df        = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(eq5d_score,
                                                       mobility,
                                                       self_care,
                                                       usual_activity,
                                                       pain_discomfort,
                                                       anxiety_depression),
                                         nomissing = TRUE,
                                         event_name, radiotherapy)
cohort_table_radiotherapy$eortc_qlq_c30 <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(c30_q1, c30_q2, c30_q3, c30_q4, c30_q5,
                                                       c30_q6, c30_q7, c30_q8, c30_q9, c30_q10,
                                                       c30_q11, c30_q12, c30_q13, c30_q14, c30_q15,
                                                       c30_q16, c30_q17, c30_q18, c30_q19, c30_q20,
                                                       c30_q21, c30_q22, c30_q23, c30_q24, c30_q25,
                                                       c30_q26, c30_q27, c30_q28, ## , c30_q29, c30_q30,
                                                       ql_raw, ql_scale,
                                                       pf_raw, pf_scale,
                                                       rf_raw, rf_scale,
                                                       ef_raw, ef_scale,
                                                       cf_raw, cf_scale,
                                                       sf_raw, sf_scale,
                                                       fa_raw, fa_scale,
                                                       nv_raw, nv_scale,
                                                       pa_raw, pa_scale,
                                                       dy_scale,
                                                       sl_scale,
                                                       ap_scale,
                                                       co_scale,
                                                       di_scale,
                                                       fi_scale),
                                         nomissing = TRUE,
                                         event_name, radiotherapy)
cohort_table_radiotherapy$eortc_qlq_br23 <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(br23_q31, br23_q32, br23_q33, br23_q34, br23_q35,
                                                       br23_q36, br23_q37, br23_q38, br23_q39, br23_q40,
                                                       br23_q41, br23_q42, br23_q43, br23_q44, br23_q45,
                                                       br23_q46, br23_q47, br23_q48, br23_q49, br23_q50,
                                                       br23_q51, br23_q52, br23_q53,
                                                       brbi_raw, brbi_scale,
                                                       brsef_raw, brsef_scale,
                                                       brsee_scale, brfu_scale,
                                                       brst_raw, brst_scale,
                                                       brbs_raw, brbs_scale,
                                                       bras_raw, bras_scale,
                                                       brhl_scale),
                                         nomissing = TRUE,
                                         event_name, radiotherapy)
cohort_table_radiotherapy$eortc_qlq_eld15 <- ctru::table_summary(df    = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(eld15_q54, eld15_q55, eld15_q56, eld15_q57, eld15_q58,
                                                       eld15_q59, eld15_q60, eld15_q61, eld15_q62, eld15_q63,
                                                       eld15_q64, eld15_q65, eld15_q66, eld15_q67, eld15_q68,
                                                       mo_raw, mo_scale,
                                                       wao_raw, wao_scale,
                                                       wo_raw, wo_scale,
                                                       mp_raw, mp_scale,
                                                       boi_raw, boi_scale,
                                                       js_scale,
                                                       fs_scale),
                                         nomissing = TRUE,
                                         event_name, radiotherapy)
cohort_table_radiotherapy$therapy_assessment <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(any_treatment,
                                                       endocrine_therapy,
                                                       radiotherapy,
                                                       radiotherapy,
                                                       trastuzumab,
                                                       surgery,
                                                       treatment_profile),
                                         nomissing = TRUE,
                                         event_name)
cohort_table_radiotherapy$endocrine_therapy <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(et_hot_flushes,
                                                       et_asthenia,
                                                       et_joint_pain,
                                                       et_vaginal_dryness,
                                                       et_hair_thinning,
                                                       et_rash,
                                                       et_nausea,
                                                       et_diarrhoea,
                                                       et_headache,
                                                       et_vaginal_bleeding,
                                                       et_vomiting,
                                                       et_somnolence),
                                         nomissing = TRUE,
                                         event_name, radiotherapy)
cohort_table_radiotherapy$radiotherapy <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(## which_breast_right,
                                                       ## which_breast_left,
                                                       r_site_breast,
                                                       r_site_axilla,
                                                       r_site_supraclavicular,
                                                       r_site_chest_wall,
                                                       r_site_other,
                                                       ## r_breast_fractions,
                                                       ## r_axilla_fractions,
                                                       ## r_supra_fractions,
                                                       ## r_chest_fractions,
                                                       ## r_orther_fractions,
                                                       r_radiotherapy_aes,
                                                       l_site_breast,
                                                       l_site_axilla,
                                                       l_site_supraclavicular,
                                                       l_site_chest_wall,
                                                       l_site_other,
                                                       ## l_breast_fractions,
                                                       ## l_axilla_fractions,
                                                       ## l_supra_fractions,
                                                       ## l_chest_fractions,
                                                       ## l_other_fractions,
                                                       l_radiotherapy_aes,
                                                       r_skin_erythema,
                                                       r_pain,
                                                       r_breast_oedema,
                                                       r_breast_shrink,
                                                       r_breast_pain,
                                                       l_skin_erythema,
                                                       l_pain,
                                                       l_breast_oedema,
                                                       l_breast_shrink,
                                                       l_breast_pain),
                                         nomissing = TRUE,
                                         event_name, radiotherapy)
cohort_table_radiotherapy$radiotherapy <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(chemo_received,
                                                       chemo_aes,
                                                       c_fatigue,
                                                       c_anaemia,
                                                       c_low_wc_count,
                                                       c_thrombocytopenia,
                                                       c_allergic,
                                                       c_hair_thinning,
                                                       c_nausea,
                                                       c_infection),
                                         nomissing = TRUE,
                                         event_name, radiotherapy)
cohort_table_radiotherapy$trastuzumab <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(trast_aes,
                                                       t_cardiac_fail,
                                                       t_flu_like,
                                                       t_nausea,
                                                       t_diarrhoea,
                                                       t_headache,
                                                       t_allergy),
                                         nomissing = TRUE,
                                         event_name, radiotherapy)
cohort_table_radiotherapy$clinical_assessment_pet <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(## uni_bilateral,
                                                       ## primary_tumour,
                                                       ## r_focal,
                                                       ## r_num_tumours,
                                                       r_cancer_palpable_pet,
                                                       ## r_size_clin_assess_pet,
                                                       r_method_assess_pet,
                                                       ## r_size_ultrasound_pet,
                                                       ## r_size_mammo_pet,
                                                       r_axillary_present_pet,
                                                       ## r_axillary_nodes_pet,
                                                       ## r_axillary_axis_pet,
                                                       ## l_focal,
                                                       ## l_num_tumours_pet,
                                                       l_cancer_palpable_pet,
                                                       ## l_size_clin_assess_pet,
                                                       l_method_assess_pet,
                                                       ## l_size_ultrasound_pet,
                                                       ## l_size_mammo_pet,
                                                       l_axillary_present_pet,
                                                       ## l_axillary_nodes_pet,
                                                       ## l_axillary_axis_pet,
                                                       metastatic,
                                                       metastatic_where_bone,
                                                       metastatic_where_lung,
                                                       metastatic_where_cervical_node,
                                                       metastatic_where_other,
                                                       metastatic_where_liver,
                                                       metastatic_where_brain,
                                                       ## proposed_treat,
                                                       ## clinical_plan2,
                                                       plan_change_surgery,
                                                       plan_change_radio,
                                                       plan_change_antioestrogen,
                                                       plan_change_other), ##,
                                                       ## plan_change_spcfy),
                                         nomissing = TRUE,
                                         event_name, radiotherapy)
cohort_table_radiotherapy$clinical_assessment_non_pet <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(recurrence_where_breast,
                                                       recurrence_where_chest_wall,
                                                       recurrence_where_axilla,
                                                       recurrence_where_metastatic,
                                                       recurrence_met_bone,
                                                       recurrence_met_liver,
                                                       recurrence_met_lung,
                                                       recurrence_met_superclavicular,
                                                       recurrence_met_brain,
                                                       recurrence_met_other,
                                                       ## recurrence_met_spcfy,
                                                       new_tumour_yn,
                                                       ## new_tumour_dtls,
                                                       ## clinical_plan,
                                                       plan_local_surgery,
                                                       plan_local_radio,
                                                       plan_local_endocrine,
                                                       plan_local_chemo,
                                                       plan_local_trast,
                                                       plan_local_other,
                                                       ## plan_local_spcfy,
                                                       plan_met_radio,
                                                       plan_met_endocrine,
                                                       plan_met_chemo,
                                                       plan_met_trast,
                                                       plan_met_other,
                                                       ## plan_met_spcfy,
                                                       plan_routine_surgery,
                                                       plan_routine_radio,
                                                       plan_routine_endocrine,
                                                       plan_routine_chemo,
                                                       plan_routine_trast,
                                                       plan_routine_other), ## ,
                                                       ## plan_routine_spcfy),
                                         nomissing = TRUE,
                                         event_name, radiotherapy)

## Chemotherapy
cohort_table_chemotherapy <- list()
cohort_table_chemotherapy$eq5d <- ctru::table_summary(df        = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(eq5d_score,
                                                       mobility,
                                                       self_care,
                                                       usual_activity,
                                                       pain_discomfort,
                                                       anxiety_depression),
                                         nomissing = TRUE,
                                         event_name, chemotherapy)
cohort_table_chemotherapy$eortc_qlq_c30 <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(c30_q1, c30_q2, c30_q3, c30_q4, c30_q5,
                                                       c30_q6, c30_q7, c30_q8, c30_q9, c30_q10,
                                                       c30_q11, c30_q12, c30_q13, c30_q14, c30_q15,
                                                       c30_q16, c30_q17, c30_q18, c30_q19, c30_q20,
                                                       c30_q21, c30_q22, c30_q23, c30_q24, c30_q25,
                                                       c30_q26, c30_q27, c30_q28, ## , c30_q29, c30_q30,
                                                       ql_raw, ql_scale,
                                                       pf_raw, pf_scale,
                                                       rf_raw, rf_scale,
                                                       ef_raw, ef_scale,
                                                       cf_raw, cf_scale,
                                                       sf_raw, sf_scale,
                                                       fa_raw, fa_scale,
                                                       nv_raw, nv_scale,
                                                       pa_raw, pa_scale,
                                                       dy_scale,
                                                       sl_scale,
                                                       ap_scale,
                                                       co_scale,
                                                       di_scale,
                                                       fi_scale),
                                         nomissing = TRUE,
                                         event_name, chemotherapy)
cohort_table_chemotherapy$eortc_qlq_br23 <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(br23_q31, br23_q32, br23_q33, br23_q34, br23_q35,
                                                       br23_q36, br23_q37, br23_q38, br23_q39, br23_q40,
                                                       br23_q41, br23_q42, br23_q43, br23_q44, br23_q45,
                                                       br23_q46, br23_q47, br23_q48, br23_q49, br23_q50,
                                                       br23_q51, br23_q52, br23_q53,
                                                       brbi_raw, brbi_scale,
                                                       brsef_raw, brsef_scale,
                                                       brsee_scale, brfu_scale,
                                                       brst_raw, brst_scale,
                                                       brbs_raw, brbs_scale,
                                                       bras_raw, bras_scale,
                                                       brhl_scale),
                                         nomissing = TRUE,
                                         event_name, chemotherapy)
cohort_table_chemotherapy$eortc_qlq_eld15 <- ctru::table_summary(df    = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(eld15_q54, eld15_q55, eld15_q56, eld15_q57, eld15_q58,
                                                       eld15_q59, eld15_q60, eld15_q61, eld15_q62, eld15_q63,
                                                       eld15_q64, eld15_q65, eld15_q66, eld15_q67, eld15_q68,
                                                       mo_raw, mo_scale,
                                                       wao_raw, wao_scale,
                                                       wo_raw, wo_scale,
                                                       mp_raw, mp_scale,
                                                       boi_raw, boi_scale,
                                                       js_scale,
                                                       fs_scale),
                                         nomissing = TRUE,
                                         event_name, chemotherapy)
cohort_table_chemotherapy$therapy_assessment <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(any_treatment,
                                                       endocrine_therapy,
                                                       radiotherapy,
                                                       chemotherapy,
                                                       trastuzumab,
                                                       surgery,
                                                       treatment_profile),
                                         nomissing = TRUE,
                                         event_name)
cohort_table_chemotherapy$endocrine_therapy <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(et_hot_flushes,
                                                       et_asthenia,
                                                       et_joint_pain,
                                                       et_vaginal_dryness,
                                                       et_hair_thinning,
                                                       et_rash,
                                                       et_nausea,
                                                       et_diarrhoea,
                                                       et_headache,
                                                       et_vaginal_bleeding,
                                                       et_vomiting,
                                                       et_somnolence),
                                         nomissing = TRUE,
                                         event_name, chemotherapy)
cohort_table_chemotherapy$radiotherapy <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(## which_breast_right,
                                                       ## which_breast_left,
                                                       r_site_breast,
                                                       r_site_axilla,
                                                       r_site_supraclavicular,
                                                       r_site_chest_wall,
                                                       r_site_other,
                                                       ## r_breast_fractions,
                                                       ## r_axilla_fractions,
                                                       ## r_supra_fractions,
                                                       ## r_chest_fractions,
                                                       ## r_orther_fractions,
                                                       r_radiotherapy_aes,
                                                       l_site_breast,
                                                       l_site_axilla,
                                                       l_site_supraclavicular,
                                                       l_site_chest_wall,
                                                       l_site_other,
                                                       ## l_breast_fractions,
                                                       ## l_axilla_fractions,
                                                       ## l_supra_fractions,
                                                       ## l_chest_fractions,
                                                       ## l_other_fractions,
                                                       l_radiotherapy_aes,
                                                       r_skin_erythema,
                                                       r_pain,
                                                       r_breast_oedema,
                                                       r_breast_shrink,
                                                       r_breast_pain,
                                                       l_skin_erythema,
                                                       l_pain,
                                                       l_breast_oedema,
                                                       l_breast_shrink,
                                                       l_breast_pain),
                                         nomissing = TRUE,
                                         event_name, chemotherapy)
cohort_table_chemotherapy$chemotherapy <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(chemo_received,
                                                       chemo_aes,
                                                       c_fatigue,
                                                       c_anaemia,
                                                       c_low_wc_count,
                                                       c_thrombocytopenia,
                                                       c_allergic,
                                                       c_hair_thinning,
                                                       c_nausea,
                                                       c_infection),
                                         nomissing = TRUE,
                                         event_name, chemotherapy)
cohort_table_chemotherapy$trastuzumab <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(trast_aes,
                                                       t_cardiac_fail,
                                                       t_flu_like,
                                                       t_nausea,
                                                       t_diarrhoea,
                                                       t_headache,
                                                       t_allergy),
                                         nomissing = TRUE,
                                         event_name, chemotherapy)
cohort_table_chemotherapy$clinical_assessment_pet <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(## uni_bilateral,
                                                       ## primary_tumour,
                                                       ## r_focal,
                                                       ## r_num_tumours,
                                                       r_cancer_palpable_pet,
                                                       r_size_clin_assess_pet,
                                                       r_method_assess_pet,
                                                       r_size_ultrasound_pet,
                                                       r_size_mammo_pet,
                                                       r_axillary_present_pet,
                                                       r_axillary_nodes_pet,
                                                       r_axillary_axis_pet,
                                                       ## l_focal,
                                                       l_num_tumours_pet,
                                                       l_cancer_palpable_pet,
                                                       l_size_clin_assess_pet,
                                                       l_method_assess_pet,
                                                       l_size_ultrasound_pet,
                                                       l_size_mammo_pet,
                                                       l_axillary_present_pet,
                                                       l_axillary_nodes_pet,
                                                       l_axillary_axis_pet,
                                                       metastatic,
                                                       metastatic_where_bone,
                                                       metastatic_where_lung,
                                                       metastatic_where_cervical_node,
                                                       metastatic_where_other,
                                                       metastatic_where_liver,
                                                       metastatic_where_brain,
                                                       ## proposed_treat,
                                                       ## clinical_plan2,
                                                       plan_change_surgery,
                                                       plan_change_radio,
                                                       plan_change_antioestrogen,
                                                       plan_change_other), ##,
                                                       ## plan_change_spcfy),
                                         nomissing = TRUE,
                                         event_name, chemotherapy)
cohort_table_chemotherapy$clinical_assessment_non_pet <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(recurrence_where_breast,
                                                       recurrence_where_chest_wall,
                                                       recurrence_where_axilla,
                                                       recurrence_where_metastatic,
                                                       recurrence_met_bone,
                                                       recurrence_met_liver,
                                                       recurrence_met_lung,
                                                       recurrence_met_superclavicular,
                                                       recurrence_met_brain,
                                                       recurrence_met_other,
                                                       ## recurrence_met_spcfy,
                                                       new_tumour_yn,
                                                       ## new_tumour_dtls,
                                                       ## clinical_plan,
                                                       plan_local_surgery,
                                                       plan_local_radio,
                                                       plan_local_endocrine,
                                                       plan_local_chemo,
                                                       plan_local_trast,
                                                       plan_local_other,
                                                       ## plan_local_spcfy,
                                                       plan_met_radio,
                                                       plan_met_endocrine,
                                                       plan_met_chemo,
                                                       plan_met_trast,
                                                       plan_met_other,
                                                       ## plan_met_spcfy,
                                                       plan_routine_surgery,
                                                       plan_routine_radio,
                                                       plan_routine_endocrine,
                                                       plan_routine_chemo,
                                                       plan_routine_trast,
                                                       plan_routine_other), ## ,
                                                       ## plan_routine_spcfy),
                                         nomissing = TRUE,
                                         event_name, chemotherapy)

## Trastuzumab
cohort_table_trastuzumab <- list()
cohort_table_trastuzumab$eq5d <- ctru::table_summary(df        = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(eq5d_score,
                                                       mobility,
                                                       self_care,
                                                       usual_activity,
                                                       pain_discomfort,
                                                       anxiety_depression),
                                         nomissing = TRUE,
                                         event_name, trastuzumab)
cohort_table_trastuzumab$eortc_qlq_c30 <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(c30_q1, c30_q2, c30_q3, c30_q4, c30_q5,
                                                       c30_q6, c30_q7, c30_q8, c30_q9, c30_q10,
                                                       c30_q11, c30_q12, c30_q13, c30_q14, c30_q15,
                                                       c30_q16, c30_q17, c30_q18, c30_q19, c30_q20,
                                                       c30_q21, c30_q22, c30_q23, c30_q24, c30_q25,
                                                       c30_q26, c30_q27, c30_q28, ## , c30_q29, c30_q30,
                                                       ql_raw, ql_scale,
                                                       pf_raw, pf_scale,
                                                       rf_raw, rf_scale,
                                                       ef_raw, ef_scale,
                                                       cf_raw, cf_scale,
                                                       sf_raw, sf_scale,
                                                       fa_raw, fa_scale,
                                                       nv_raw, nv_scale,
                                                       pa_raw, pa_scale,
                                                       dy_scale,
                                                       sl_scale,
                                                       ap_scale,
                                                       co_scale,
                                                       di_scale,
                                                       fi_scale),
                                         nomissing = TRUE,
                                         event_name, trastuzumab)
cohort_table_trastuzumab$eortc_qlq_br23 <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(br23_q31, br23_q32, br23_q33, br23_q34, br23_q35,
                                                       br23_q36, br23_q37, br23_q38, br23_q39, br23_q40,
                                                       br23_q41, br23_q42, br23_q43, br23_q44, br23_q45,
                                                       br23_q46, br23_q47, br23_q48, br23_q49, br23_q50,
                                                       br23_q51, br23_q52, br23_q53,
                                                       brbi_raw, brbi_scale,
                                                       brsef_raw, brsef_scale,
                                                       brsee_scale, brfu_scale,
                                                       brst_raw, brst_scale,
                                                       brbs_raw, brbs_scale,
                                                       bras_raw, bras_scale,
                                                       brhl_scale),
                                         nomissing = TRUE,
                                         event_name, trastuzumab)
cohort_table_trastuzumab$eortc_qlq_eld15 <- ctru::table_summary(df    = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(eld15_q54, eld15_q55, eld15_q56, eld15_q57, eld15_q58,
                                                       eld15_q59, eld15_q60, eld15_q61, eld15_q62, eld15_q63,
                                                       eld15_q64, eld15_q65, eld15_q66, eld15_q67, eld15_q68,
                                                       mo_raw, mo_scale,
                                                       wao_raw, wao_scale,
                                                       wo_raw, wo_scale,
                                                       mp_raw, mp_scale,
                                                       boi_raw, boi_scale,
                                                       js_scale,
                                                       fs_scale),
                                         nomissing = TRUE,
                                         event_name, trastuzumab)
cohort_table_trastuzumab$therapy_assessment <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(any_treatment,
                                                       trastuzumab,
                                                       radiotherapy,
                                                       trastuzumab,
                                                       trastuzumab,
                                                       trastuzumab,
                                                       treatment_profile),
                                         nomissing = TRUE,
                                         event_name)
cohort_table_trastuzumab$trastuzumab <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(et_hot_flushes,
                                                       et_asthenia,
                                                       et_joint_pain,
                                                       et_vaginal_dryness,
                                                       et_hair_thinning,
                                                       et_rash,
                                                       et_nausea,
                                                       et_diarrhoea,
                                                       et_headache,
                                                       et_vaginal_bleeding,
                                                       et_vomiting,
                                                       et_somnolence),
                                         nomissing = TRUE,
                                         event_name, trastuzumab)
cohort_table_trastuzumab$radiotherapy <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(## which_breast_right,
                                                       ## which_breast_left,
                                                       r_site_breast,
                                                       r_site_axilla,
                                                       r_site_supraclavicular,
                                                       r_site_chest_wall,
                                                       r_site_other,
                                                       ## r_breast_fractions,
                                                       ## r_axilla_fractions,
                                                       ## r_supra_fractions,
                                                       ## r_chest_fractions,
                                                       ## r_orther_fractions,
                                                       r_radiotherapy_aes,
                                                       l_site_breast,
                                                       l_site_axilla,
                                                       l_site_supraclavicular,
                                                       l_site_chest_wall,
                                                       l_site_other,
                                                       ## l_breast_fractions,
                                                       ## l_axilla_fractions,
                                                       ## l_supra_fractions,
                                                       ## l_chest_fractions,
                                                       ## l_other_fractions,
                                                       l_radiotherapy_aes,
                                                       r_skin_erythema,
                                                       r_pain,
                                                       r_breast_oedema,
                                                       r_breast_shrink,
                                                       r_breast_pain,
                                                       l_skin_erythema,
                                                       l_pain,
                                                       l_breast_oedema,
                                                       l_breast_shrink,
                                                       l_breast_pain),
                                         nomissing = TRUE,
                                         event_name, trastuzumab)
cohort_table_trastuzumab$trastuzumab <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(chemo_received,
                                                       chemo_aes,
                                                       c_fatigue,
                                                       c_anaemia,
                                                       c_low_wc_count,
                                                       c_thrombocytopenia,
                                                       c_allergic,
                                                       c_hair_thinning,
                                                       c_nausea,
                                                       c_infection),
                                         nomissing = TRUE,
                                         event_name, trastuzumab)
cohort_table_trastuzumab$trastuzumab <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(trast_aes,
                                                       t_cardiac_fail,
                                                       t_flu_like,
                                                       t_nausea,
                                                       t_diarrhoea,
                                                       t_headache,
                                                       t_allergy),
                                         nomissing = TRUE,
                                         event_name, trastuzumab)
cohort_table_trastuzumab$clinical_assessment_pet <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(## uni_bilateral,
                                                       ## primary_tumour,
                                                       ## r_focal,
                                                       ## r_num_tumours,
                                                       r_cancer_palpable_pet,
                                                       r_size_clin_assess_pet,
                                                       r_method_assess_pet,
                                                       r_size_ultrasound_pet,
                                                       r_size_mammo_pet,
                                                       r_axillary_present_pet,
                                                       r_axillary_nodes_pet,
                                                       r_axillary_axis_pet,
                                                       ## l_focal,
                                                       l_num_tumours_pet,
                                                       l_cancer_palpable_pet,
                                                       l_size_clin_assess_pet,
                                                       l_method_assess_pet,
                                                       l_size_ultrasound_pet,
                                                       l_size_mammo_pet,
                                                       l_axillary_present_pet,
                                                       l_axillary_nodes_pet,
                                                       l_axillary_axis_pet,
                                                       metastatic,
                                                       metastatic_where_bone,
                                                       metastatic_where_lung,
                                                       metastatic_where_cervical_node,
                                                       metastatic_where_other,
                                                       metastatic_where_liver,
                                                       metastatic_where_brain,
                                                       ## proposed_treat,
                                                       ## clinical_plan2,
                                                       plan_change_trastuzumab,
                                                       plan_change_radio,
                                                       plan_change_antioestrogen,
                                                       plan_change_other), ##,
                                                       ## plan_change_spcfy),
                                         nomissing = TRUE,
                                         event_name, trastuzumab)
cohort_table_trastuzumab$clinical_assessment_non_pet <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(recurrence_where_breast,
                                                       recurrence_where_chest_wall,
                                                       recurrence_where_axilla,
                                                       recurrence_where_metastatic,
                                                       recurrence_met_bone,
                                                       recurrence_met_liver,
                                                       recurrence_met_lung,
                                                       recurrence_met_superclavicular,
                                                       recurrence_met_brain,
                                                       recurrence_met_other,
                                                       ## recurrence_met_spcfy,
                                                       new_tumour_yn,
                                                       ## new_tumour_dtls,
                                                       ## clinical_plan,
                                                       plan_local_surgery,
                                                       plan_local_radio,
                                                       plan_local_endocrine,
                                                       plan_local_chemo,
                                                       plan_local_trast,
                                                       plan_local_other,
                                                       ## plan_local_spcfy,
                                                       plan_met_radio,
                                                       plan_met_endocrine,
                                                       plan_met_chemo,
                                                       plan_met_trast,
                                                       plan_met_other,
                                                       ## plan_met_spcfy,
                                                       plan_routine_surgery,
                                                       plan_routine_radio,
                                                       plan_routine_endocrine,
                                                       plan_routine_chemo,
                                                       plan_routine_trast,
                                                       plan_routine_other), ## ,
                                                       ## plan_routine_spcfy),
                                         nomissing = TRUE,
                                         event_name, trastuzumab)

## Surgery
cohort_table_surgery <- list()
cohort_table_surgery$eq5d <- ctru::table_summary(df        = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(eq5d_score,
                                                       mobility,
                                                       self_care,
                                                       usual_activity,
                                                       pain_discomfort,
                                                       anxiety_depression),
                                         nomissing = TRUE,
                                         event_name, surgery)
cohort_table_surgery$eortc_qlq_c30 <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(c30_q1, c30_q2, c30_q3, c30_q4, c30_q5,
                                                       c30_q6, c30_q7, c30_q8, c30_q9, c30_q10,
                                                       c30_q11, c30_q12, c30_q13, c30_q14, c30_q15,
                                                       c30_q16, c30_q17, c30_q18, c30_q19, c30_q20,
                                                       c30_q21, c30_q22, c30_q23, c30_q24, c30_q25,
                                                       c30_q26, c30_q27, c30_q28, ## , c30_q29, c30_q30,
                                                       ql_raw, ql_scale,
                                                       pf_raw, pf_scale,
                                                       rf_raw, rf_scale,
                                                       ef_raw, ef_scale,
                                                       cf_raw, cf_scale,
                                                       sf_raw, sf_scale,
                                                       fa_raw, fa_scale,
                                                       nv_raw, nv_scale,
                                                       pa_raw, pa_scale,
                                                       dy_scale,
                                                       sl_scale,
                                                       ap_scale,
                                                       co_scale,
                                                       di_scale,
                                                       fi_scale),
                                         nomissing = TRUE,
                                         event_name, surgery)
cohort_table_surgery$eortc_qlq_br23 <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(br23_q31, br23_q32, br23_q33, br23_q34, br23_q35,
                                                       br23_q36, br23_q37, br23_q38, br23_q39, br23_q40,
                                                       br23_q41, br23_q42, br23_q43, br23_q44, br23_q45,
                                                       br23_q46, br23_q47, br23_q48, br23_q49, br23_q50,
                                                       br23_q51, br23_q52, br23_q53,
                                                       brbi_raw, brbi_scale,
                                                       brsef_raw, brsef_scale,
                                                       brsee_scale, brfu_scale,
                                                       brst_raw, brst_scale,
                                                       brbs_raw, brbs_scale,
                                                       bras_raw, bras_scale,
                                                       brhl_scale),
                                         nomissing = TRUE,
                                         event_name, surgery)
cohort_table_surgery$eortc_qlq_eld15 <- ctru::table_summary(df    = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(eld15_q54, eld15_q55, eld15_q56, eld15_q57, eld15_q58,
                                                       eld15_q59, eld15_q60, eld15_q61, eld15_q62, eld15_q63,
                                                       eld15_q64, eld15_q65, eld15_q66, eld15_q67, eld15_q68,
                                                       mo_raw, mo_scale,
                                                       wao_raw, wao_scale,
                                                       wo_raw, wo_scale,
                                                       mp_raw, mp_scale,
                                                       boi_raw, boi_scale,
                                                       js_scale,
                                                       fs_scale),
                                         nomissing = TRUE,
                                         event_name, surgery)
cohort_table_surgery$therapy_assessment <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(any_treatment,
                                                       surgery,
                                                       radiotherapy,
                                                       surgery,
                                                       trastuzumab,
                                                       surgery,
                                                       treatment_profile),
                                         nomissing = TRUE,
                                         event_name)
cohort_table_surgery$surgery <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(et_hot_flushes,
                                                       et_asthenia,
                                                       et_joint_pain,
                                                       et_vaginal_dryness,
                                                       et_hair_thinning,
                                                       et_rash,
                                                       et_nausea,
                                                       et_diarrhoea,
                                                       et_headache,
                                                       et_vaginal_bleeding,
                                                       et_vomiting,
                                                       et_somnolence),
                                         nomissing = TRUE,
                                         event_name, surgery)
cohort_table_surgery$radiotherapy <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(## which_breast_right,
                                                       ## which_breast_left,
                                                       r_site_breast,
                                                       r_site_axilla,
                                                       r_site_supraclavicular,
                                                       r_site_chest_wall,
                                                       r_site_other,
                                                       ## r_breast_fractions,
                                                       ## r_axilla_fractions,
                                                       ## r_supra_fractions,
                                                       ## r_chest_fractions,
                                                       ## r_orther_fractions,
                                                       r_radiotherapy_aes,
                                                       l_site_breast,
                                                       l_site_axilla,
                                                       l_site_supraclavicular,
                                                       l_site_chest_wall,
                                                       l_site_other,
                                                       ## l_breast_fractions,
                                                       ## l_axilla_fractions,
                                                       ## l_supra_fractions,
                                                       ## l_chest_fractions,
                                                       ## l_other_fractions,
                                                       l_radiotherapy_aes,
                                                       r_skin_erythema,
                                                       r_pain,
                                                       r_breast_oedema,
                                                       r_breast_shrink,
                                                       r_breast_pain,
                                                       l_skin_erythema,
                                                       l_pain,
                                                       l_breast_oedema,
                                                       l_breast_shrink,
                                                       l_breast_pain),
                                         nomissing = TRUE,
                                         event_name, surgery)
cohort_table_surgery$surgery <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(chemo_received,
                                                       chemo_aes,
                                                       c_fatigue,
                                                       c_anaemia,
                                                       c_low_wc_count,
                                                       c_thrombocytopenia,
                                                       c_allergic,
                                                       c_hair_thinning,
                                                       c_nausea,
                                                       c_infection),
                                         nomissing = TRUE,
                                         event_name, surgery)
cohort_table_surgery$trastuzumab <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(trast_aes,
                                                       t_cardiac_fail,
                                                       t_flu_like,
                                                       t_nausea,
                                                       t_diarrhoea,
                                                       t_headache,
                                                       t_allergy),
                                         nomissing = TRUE,
                                         event_name, surgery)
cohort_table_surgery$clinical_assessment_pet <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(## uni_bilateral,
                                                       ## primary_tumour,
                                                       ## r_focal,
                                                       ## r_num_tumours,
                                                       r_cancer_palpable_pet,
                                                       r_size_clin_assess_pet,
                                                       r_method_assess_pet,
                                                       r_size_ultrasound_pet,
                                                       r_size_mammo_pet,
                                                       r_axillary_present_pet,
                                                       r_axillary_nodes_pet,
                                                       r_axillary_axis_pet,
                                                       ## l_focal,
                                                       l_num_tumours_pet,
                                                       l_cancer_palpable_pet,
                                                       l_size_clin_assess_pet,
                                                       l_method_assess_pet,
                                                       l_size_ultrasound_pet,
                                                       l_size_mammo_pet,
                                                       l_axillary_present_pet,
                                                       l_axillary_nodes_pet,
                                                       l_axillary_axis_pet,
                                                       metastatic,
                                                       metastatic_where_bone,
                                                       metastatic_where_lung,
                                                       metastatic_where_cervical_node,
                                                       metastatic_where_other,
                                                       metastatic_where_liver,
                                                       metastatic_where_brain,
                                                       ## proposed_treat,
                                                       ## clinical_plan2,
                                                       plan_change_surgery,
                                                       plan_change_radio,
                                                       plan_change_antioestrogen,
                                                       plan_change_other), ##,
                                                       ## plan_change_spcfy),
                                         nomissing = TRUE,
                                         event_name, surgery)
cohort_table_surgery$clinical_assessment_non_pet <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(recurrence_where_breast,
                                                       recurrence_where_chest_wall,
                                                       recurrence_where_axilla,
                                                       recurrence_where_metastatic,
                                                       recurrence_met_bone,
                                                       recurrence_met_liver,
                                                       recurrence_met_lung,
                                                       recurrence_met_superclavicular,
                                                       recurrence_met_brain,
                                                       recurrence_met_other,
                                                       ## recurrence_met_spcfy,
                                                       new_tumour_yn,
                                                       ## new_tumour_dtls,
                                                       ## clinical_plan,
                                                       plan_local_surgery,
                                                       plan_local_radio,
                                                       plan_local_endocrine,
                                                       plan_local_chemo,
                                                       plan_local_trast,
                                                       plan_local_other,
                                                       ## plan_local_spcfy,
                                                       plan_met_radio,
                                                       plan_met_endocrine,
                                                       plan_met_chemo,
                                                       plan_met_trast,
                                                       plan_met_other,
                                                       ## plan_met_spcfy,
                                                       plan_routine_surgery,
                                                       plan_routine_radio,
                                                       plan_routine_endocrine,
                                                       plan_routine_chemo,
                                                       plan_routine_trast,
                                                       plan_routine_other), ## ,
                                                       ## plan_routine_spcfy),
                                         nomissing = TRUE,
                                         event_name, surgery)


## Treatment Profiles
cohort_table_treatment_profile <- list()
cohort_table_treatment_profile$eq5d <- ctru::table_summary(df        = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(eq5d_score,
                                                       mobility,
                                                       self_care,
                                                       usual_activity,
                                                       pain_discomfort,
                                                       anxiety_depression),
                                         nomissing = TRUE,
                                         event_name, treatment_profile)
cohort_table_treatment_profile$eortc_qlq_c30 <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(c30_q1, c30_q2, c30_q3, c30_q4, c30_q5,
                                                       c30_q6, c30_q7, c30_q8, c30_q9, c30_q10,
                                                       c30_q11, c30_q12, c30_q13, c30_q14, c30_q15,
                                                       c30_q16, c30_q17, c30_q18, c30_q19, c30_q20,
                                                       c30_q21, c30_q22, c30_q23, c30_q24, c30_q25,
                                                       c30_q26, c30_q27, c30_q28, ## , c30_q29, c30_q30,
                                                       ql_raw, ql_scale,
                                                       pf_raw, pf_scale,
                                                       rf_raw, rf_scale,
                                                       ef_raw, ef_scale,
                                                       cf_raw, cf_scale,
                                                       sf_raw, sf_scale,
                                                       fa_raw, fa_scale,
                                                       nv_raw, nv_scale,
                                                       pa_raw, pa_scale,
                                                       dy_scale,
                                                       sl_scale,
                                                       ap_scale,
                                                       co_scale,
                                                       di_scale,
                                                       fi_scale),
                                         nomissing = TRUE,
                                         event_name, treatment_profile)
cohort_table_treatment_profile$eortc_qlq_br23 <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(br23_q31, br23_q32, br23_q33, br23_q34, br23_q35,
                                                       br23_q36, br23_q37, br23_q38, br23_q39, br23_q40,
                                                       br23_q41, br23_q42, br23_q43, br23_q44, br23_q45,
                                                       br23_q46, br23_q47, br23_q48, br23_q49, br23_q50,
                                                       br23_q51, br23_q52, br23_q53,
                                                       brbi_raw, brbi_scale,
                                                       brsef_raw, brsef_scale,
                                                       brsee_scale, brfu_scale,
                                                       brst_raw, brst_scale,
                                                       brbs_raw, brbs_scale,
                                                       bras_raw, bras_scale,
                                                       brhl_scale),
                                         nomissing = TRUE,
                                         event_name, treatment_profile)
cohort_table_treatment_profile$eortc_qlq_eld15 <- ctru::table_summary(df    = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(eld15_q54, eld15_q55, eld15_q56, eld15_q57, eld15_q58,
                                                       eld15_q59, eld15_q60, eld15_q61, eld15_q62, eld15_q63,
                                                       eld15_q64, eld15_q65, eld15_q66, eld15_q67, eld15_q68,
                                                       mo_raw, mo_scale,
                                                       wao_raw, wao_scale,
                                                       wo_raw, wo_scale,
                                                       mp_raw, mp_scale,
                                                       boi_raw, boi_scale,
                                                       js_scale,
                                                       fs_scale),
                                         nomissing = TRUE,
                                         event_name, treatment_profile)
cohort_table_treatment_profile$therapy_assessment <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(any_treatment,
                                                       surgery,
                                                       radiotherapy,
                                                       surgery,
                                                       trastuzumab,
                                                       surgery,
                                                       treatment_profile),
                                         nomissing = TRUE,
                                         event_name)
cohort_table_treatment_profile$surgery <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(et_hot_flushes,
                                                       et_asthenia,
                                                       et_joint_pain,
                                                       et_vaginal_dryness,
                                                       et_hair_thinning,
                                                       et_rash,
                                                       et_nausea,
                                                       et_diarrhoea,
                                                       et_headache,
                                                       et_vaginal_bleeding,
                                                       et_vomiting,
                                                       et_somnolence),
                                         nomissing = TRUE,
                                         event_name, treatment_profile)
cohort_table_treatment_profile$radiotherapy <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(## which_breast_right,
                                                       ## which_breast_left,
                                                       r_site_breast,
                                                       r_site_axilla,
                                                       r_site_supraclavicular,
                                                       r_site_chest_wall,
                                                       r_site_other,
                                                       ## r_breast_fractions,
                                                       ## r_axilla_fractions,
                                                       ## r_supra_fractions,
                                                       ## r_chest_fractions,
                                                       ## r_orther_fractions,
                                                       r_radiotherapy_aes,
                                                       l_site_breast,
                                                       l_site_axilla,
                                                       l_site_supraclavicular,
                                                       l_site_chest_wall,
                                                       l_site_other,
                                                       ## l_breast_fractions,
                                                       ## l_axilla_fractions,
                                                       ## l_supra_fractions,
                                                       ## l_chest_fractions,
                                                       ## l_other_fractions,
                                                       l_radiotherapy_aes,
                                                       r_skin_erythema,
                                                       r_pain,
                                                       r_breast_oedema,
                                                       r_breast_shrink,
                                                       r_breast_pain,
                                                       l_skin_erythema,
                                                       l_pain,
                                                       l_breast_oedema,
                                                       l_breast_shrink,
                                                       l_breast_pain),
                                         nomissing = TRUE,
                                         event_name, treatment_profile)
cohort_table_treatment_profile$surgery <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(chemo_received,
                                                       chemo_aes,
                                                       c_fatigue,
                                                       c_anaemia,
                                                       c_low_wc_count,
                                                       c_thrombocytopenia,
                                                       c_allergic,
                                                       c_hair_thinning,
                                                       c_nausea,
                                                       c_infection),
                                         nomissing = TRUE,
                                         event_name, treatment_profile)
cohort_table_treatment_profile$trastuzumab <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(trast_aes,
                                                       t_cardiac_fail,
                                                       t_flu_like,
                                                       t_nausea,
                                                       t_diarrhoea,
                                                       t_headache,
                                                       t_allergy),
                                         nomissing = TRUE,
                                         event_name, treatment_profile)
cohort_table_treatment_profile$clinical_assessment_pet <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(## uni_bilateral,
                                                       ## primary_tumour,
                                                       ## r_focal,
                                                       ## r_num_tumours,
                                                       r_cancer_palpable_pet,
                                                       r_size_clin_assess_pet,
                                                       r_method_assess_pet,
                                                       r_size_ultrasound_pet,
                                                       r_size_mammo_pet,
                                                       r_axillary_present_pet,
                                                       r_axillary_nodes_pet,
                                                       r_axillary_axis_pet,
                                                       ## l_focal,
                                                       l_num_tumours_pet,
                                                       l_cancer_palpable_pet,
                                                       l_size_clin_assess_pet,
                                                       l_method_assess_pet,
                                                       l_size_ultrasound_pet,
                                                       l_size_mammo_pet,
                                                       l_axillary_present_pet,
                                                       l_axillary_nodes_pet,
                                                       l_axillary_axis_pet,
                                                       metastatic,
                                                       metastatic_where_bone,
                                                       metastatic_where_lung,
                                                       metastatic_where_cervical_node,
                                                       metastatic_where_other,
                                                       metastatic_where_liver,
                                                       metastatic_where_brain,
                                                       ## proposed_treat,
                                                       ## clinical_plan2,
                                                       plan_change_surgery,
                                                       plan_change_radio,
                                                       plan_change_antioestrogen,
                                                       plan_change_other), ##,
                                                       ## plan_change_spcfy),
                                         nomissing = TRUE,
                                         event_name, treatment_profile)
cohort_table_treatment_profile$clinical_assessment_non_pet <- ctru::table_summary(df            = age_gap,
                                         lookup    = master$lookups_fields,
                                         id        = individual_id,
                                         select    = c(recurrence_where_breast,
                                                       recurrence_where_chest_wall,
                                                       recurrence_where_axilla,
                                                       recurrence_where_metastatic,
                                                       recurrence_met_bone,
                                                       recurrence_met_liver,
                                                       recurrence_met_lung,
                                                       recurrence_met_superclavicular,
                                                       recurrence_met_brain,
                                                       recurrence_met_other,
                                                       ## recurrence_met_spcfy,
                                                       new_tumour_yn,
                                                       ## new_tumour_dtls,
                                                       ## clinical_plan,
                                                       plan_local_surgery,
                                                       plan_local_radio,
                                                       plan_local_endocrine,
                                                       plan_local_chemo,
                                                       plan_local_trast,
                                                       plan_local_other,
                                                       ## plan_local_spcfy,
                                                       plan_met_radio,
                                                       plan_met_endocrine,
                                                       plan_met_chemo,
                                                       plan_met_trast,
                                                       plan_met_other,
                                                       ## plan_met_spcfy,
                                                       plan_routine_surgery,
                                                       plan_routine_radio,
                                                       plan_routine_endocrine,
                                                       plan_routine_chemo,
                                                       plan_routine_trast,
                                                       plan_routine_other), ## ,
                                                       ## plan_routine_spcfy),
                                         nomissing = TRUE,
                                         event_name, treatment_profile)

```
